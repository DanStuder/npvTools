% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/exact_bm_dist.R
\name{exact_bm_dist}
\alias{exact_bm_dist}
\title{Exakte Brunner-Munzel Permutationsverteilung}
\usage{
exact_bm_dist(data)
}
\arguments{
\item{data}{Ein data.frame mit den Spalten \code{value} (numerischer Wert)
und \code{group} (Faktor mit den Levels 1 und 2).}
}
\value{
Ein tibble mit den Spalten:
\describe{
\item{W}{Brunner-Munzel Teststatistik-Wert.}
\item{n_perm}{Anzahl der Permutationen, die diesen \code{W}-Wert liefern.}
}
}
\description{
Berechnet die exakte Permutationsverteilung der Brunner-Munzel-Teststatistik
\code{W} für zwei unabhängige Stichproben durch eine effiziente Gruppierung,
die gleiche Permutationen und Rangbindungen berücksichtigt.
}
\details{
Die Funktion setzt voraus, dass die Eingabedaten genau zwei Gruppen als Faktor mit
den Ebenen 1 und 2 enthalten, wobei Gruppe 1 \code{n1} Beobachtungen hat.
Zurückgegeben wird ein tidy tibble mit der Teststatistik \code{W} und der Häufigkeit
\code{n_perm} der jeweiligen Werte über alle eindeutigen Permutationen.

Die interne Funktion \code{calc_W()} berechnet Ränge, Rangmittelwerte \code{R1} und \code{R2},
gruppenspezifische Varianzen \code{S1_2} und \code{S2_2} sowie die gepoolte Varianz \code{sigma2},
um die Differenz der Rangmittel zu standardisieren. Die Permutationen werden effizient
mit \code{combn()} generiert und mittels \code{dplyr::group_by()} auf sortierten Vektoren
gruppiert, um Doppelberechnungen zu vermeiden. Dieser Ansatz eignet sich für kleine
Stichproben (z.B. Gesamtn = 20), bei denen eine vollständige Enumerierung machbar ist.
}
\examples{
data <- data.frame(
  value = c(0, 0, 1, 1, 1, 1, 1, 1, 3, 3),
  group = factor(rep(1:2, each = 5))
)

exact_bm_dist(data)

}
